System.register(["jimu-core","jimu-core/react"],(function(e,t){var n={},o={};return{setters:[function(e){n.DataSourceComponent=e.DataSourceComponent,n.DataSourceManager=e.DataSourceManager,n.React=e.React,n.classNames=e.classNames,n.css=e.css,n.jsx=e.jsx},function(e){o.useCallback=e.useCallback,o.useEffect=e.useEffect,o.useState=e.useState}],execute:function(){e((()=>{var e={568:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M11.347 2.146a.485.485 0 0 1 0 .708L5.76 8l5.587 5.146a.486.486 0 0 1 0 .708.54.54 0 0 1-.738 0l-5.956-5.5a.485.485 0 0 1 0-.708l5.956-5.5a.54.54 0 0 1 .738 0" clip-rule="evenodd"></path></svg>'},943:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M4.653 13.854a.485.485 0 0 1 0-.708L10.24 8 4.653 2.854a.485.485 0 0 1 0-.708.54.54 0 0 1 .738 0l5.956 5.5a.485.485 0 0 1 0 .708l-5.956 5.5a.54.54 0 0 1-.738 0" clip-rule="evenodd"></path></svg>'},244:e=>{"use strict";e.exports=n},972:e=>{"use strict";e.exports=o}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,a),r.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="";var r={};return a.p=window.jimuConfig.baseUrl,(()=>{"use strict";a.r(r),a.d(r,{__set_webpack_public_path__:()=>S,default:()=>b});var e=a(244),t=a(972),n=a(568),o=a.n(n),s=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(n[o[a]]=e[o[a]])}return n};const c=t=>{const n=window.SVG,{className:a}=t,r=s(t,["className"]),c=(0,e.classNames)("jimu-icon jimu-icon-component",a);return n?e.React.createElement(n,Object.assign({className:c,src:o()},r)):e.React.createElement("svg",Object.assign({className:c},r))};var i=a(943),u=a.n(i),l=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(n[o[a]]=e[o[a]])}return n};const d=t=>{const n=window.SVG,{className:o}=t,a=l(t,["className"]),r=(0,e.classNames)("jimu-icon jimu-icon-component",o);return n?e.React.createElement(n,Object.assign({className:r,src:u()},a)):e.React.createElement("svg",Object.assign({className:r},a))};var f=function(e,t,n,o){return new(n||(n=Promise))((function(a,r){function s(e){try{i(o.next(e))}catch(e){r(e)}}function c(e){try{i(o.throw(e))}catch(e){r(e)}}function i(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}i((o=o.apply(e,t||[])).next())}))};class h{constructor(e){this.delay=e,this.timeoutId=null}execute(e){return f(this,void 0,void 0,(function*(){this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout((()=>f(this,void 0,void 0,(function*(){try{yield e()}catch(e){console.error("Error in debounced function:",e)}this.timeoutId=null}))),this.delay)}))}}const p=({useDataSources:n,children:o,onDataSourceInfoChange:a,onDataSourceStatusChange:r,onDataSourceCreated:s,useDebounceExecutor:c})=>{const[i]=(0,t.useState)(new h(300)),u=(0,t.useCallback)(((e,t)=>{c||void 0===c?i.execute((()=>{null==a||a(e,t)})):null==a||a(e,t)}),[c,i,a]),l=(0,t.useCallback)(((e,t)=>{c||void 0===c?i.execute((()=>{null==r||r(e,t)})):null==r||r(e,t)}),[c,i,r]),d=(0,t.useCallback)((()=>{let t=o;for(let o=0;o<n.length;o++)t=(0,e.jsx)(e.DataSourceComponent,{useDataSource:n[o],onDataSourceInfoChange:u,onDataSourceStatusChange:l,onDataSourceCreated:s},t);return t}),[o,n,u,l,s]),[f,p]=(0,t.useState)(null);return(0,t.useEffect)((()=>{n&&n.length>0?p(d()):p(o)}),[o,d,n]),f};var g=function(e,t,n,o){return new(n||(n=Promise))((function(a,r){function s(e){try{i(o.next(e))}catch(e){r(e)}}function c(e){try{i(o.throw(e))}catch(e){r(e)}}function i(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}i((o=o.apply(e,t||[])).next())}))};const m=({imgUrls:n,objectFit:o})=>{const[a,r]=(0,t.useState)(0),s=(0,t.useCallback)((()=>{r((a+1)%n.length)}),[a,n]),i=(0,t.useCallback)((()=>{r((a-1+n.length)%n.length)}),[a,n]),u=e.css`
    width: 30px;
    height: 30px;
    border-top-left-radius: 50%;
    border-top-right-radius: 50%;
    border-bottom-right-radius: 50%;
    border-bottom-left-radius: 50%;
    align-items: center;
    display: flex;
    justify-content: center;
    background-color: rgba(255, 255, 255, 0.5);
  `;return 0===n.length?(0,e.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}}):(0,e.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}},(0,e.jsx)("img",{src:n[a],style:{width:"100%",height:"100%",objectFit:null!=o?o:"contain"}}),n.length>1&&0!==a&&(0,e.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"40%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},onClick:i},(0,e.jsx)("div",{css:u},(0,e.jsx)(c,{size:"15px"}))),n.length>1&&a!==n.length-1&&(0,e.jsx)("div",{style:{position:"absolute",top:0,right:0,width:"40%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},onClick:s},(0,e.jsx)("div",{css:u},(0,e.jsx)(d,{size:"15px"}))))},v=t=>{const n=e.DataSourceManager.getInstance().getDataSource(t);return null!=n?n:void 0},y=(e,t,n)=>g(void 0,void 0,void 0,(function*(){if(void 0===e.url||null===e.url)return[];const o=`${e.url}/${t}/attachments?f=json`,a=yield fetch(o),r=yield a.json();if(a.ok){const o=[];for(const a of r.attachmentInfos)n?o.push(`${e.url}/${t}/attachments/${a.attachmentid}?w=${n}`):o.push(`${e.url}/${t}/attachments/${a.attachmentid}`);return o}return[]}));function b(n){const[o,a]=(0,t.useState)([]),[,r]=(0,t.useState)(""),s=(0,t.useCallback)((()=>g(this,void 0,void 0,(function*(){let e,t;if(void 0===n.repeatedDataSource||null===n.repeatedDataSource||Array.isArray(n.repeatedDataSource))if(n.useDataSources&&n.useDataSources.length>0){const o=n.useDataSources[0].dataSourceId;if(e=v(o),void 0!==e){const n=e.getSelectedRecords();t=n.length>0?n[0].getId():void 0}else t=void 0}else e=void 0,t=void 0;else r(`Data source: ${null===n.repeatedDataSource}`),e=v(n.repeatedDataSource.dataSourceId),t=n.repeatedDataSource.record.getId();if(null==e||void 0===t)return void r(`Datasource is not avaiable? ${null==e}, object id is not avaiable? ${void 0===t}`);r(`Data source: ${e.url}, object id: ${t}`);const o=yield y(e,t,n.config.attachmentSetWidth);a(o)}))),[n.repeatedDataSource,n.config.attachmentSetWidth,n.useDataSources]),c=(0,t.useCallback)((()=>{"attachment"===n.config.source?s():a([n.config.imgUrl])}),[s,n.config.imgUrl,n.config.source]);return(0,t.useEffect)((()=>{c()}),[c]),(0,e.jsx)(p,{useDataSources:n.useDataSources,onDataSourceInfoChange:c,useDebounceExecutor:!1},(0,e.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}},(0,e.jsx)(m,{imgUrls:o,objectFit:n.config.objectFit})))}function S(e){a.p=e}})(),r})())}}}));