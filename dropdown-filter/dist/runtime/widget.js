System.register(["jimu-core","jimu-core/react","jimu-ui"],(function(e,t){var o={},n={},a={};return{setters:[function(e){o.DataSourceComponent=e.DataSourceComponent,o.DataSourceManager=e.DataSourceManager,o.jsx=e.jsx},function(e){n.useCallback=e.useCallback,n.useEffect=e.useEffect,n.useState=e.useState},function(e){a.Option=e.Option,a.Select=e.Select}],execute:function(){e((()=>{var e={244:e=>{"use strict";e.exports=o},972:e=>{"use strict";e.exports=n},321:e=>{"use strict";e.exports=a}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,r),a.exports}r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="";var s={};return r.p=window.jimuConfig.baseUrl,(()=>{"use strict";r.r(s),r.d(s,{__set_webpack_public_path__:()=>c,default:()=>u});var e=r(244),t=r(972);const o=({useDataSources:o,children:n,onDataSourceInfoChange:a,onDataSourceCreated:r})=>{const s=(0,t.useCallback)((()=>{let t=n;for(let n=0;n<o.length;n++)t=(0,e.jsx)(e.DataSourceComponent,{useDataSource:o[n],onDataSourceInfoChange:a,onDataSourceCreated:r},t);return t}),[n,a,r,o]),[i,u]=(0,t.useState)(null);return(0,t.useEffect)((()=>{o&&o.length>0?u(s()):u(n)}),[n,s,o]),i};var n=r(321);const a=(e,t,o)=>e.split(t).join(o),i=e=>/\{\d+\}/g.test(e);function u(r){var s;const[,u]=(0,t.useState)(-1),c=(0,t.useCallback)((t=>{if(!r.useDataSources||0===r.useDataSources.length||void 0===r.config.fieldNames||void 0===r.config.options)return;if(r.useDataSources.length!==r.config.fieldNames.length)return;if(void 0===r.config.options[t])return;const o=r.config.options[t].sqlExpression,n=i(o)?parseFloat(o.substring(1,o.length-1)):void 0;for(let t=0;t<r.useDataSources.length;t++){const s=e.DataSourceManager.getInstance().getDataSource(r.useDataSources[t].dataSourceId);if(null==s||void 0===r.config.fieldNames[t])continue;let i=a(o,"{}",r.config.fieldNames[t]);void 0!==n&&n!==t?i="1 = 0":void 0!==n&&n===t&&(i="1 = 1");const u={where:i};s.updateQueryParams(u,r.id)}}),[r.config.fieldNames,r.config.options,r.id,r.useDataSources]),l=(0,t.useCallback)((e=>{e<0||e>=r.config.options.length||u((t=>(t!==e&&c(e),e)))}),[c,r.config.options.length]);return(0,e.jsx)("div",{style:{alignItems:"center",display:"flex",justifyContent:"center",width:"100%",height:"100%",backgroundColor:"transparent",flexDirection:"column"}},(0,e.jsx)(o,{useDataSources:r.useDataSources},(0,e.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",gap:"10px",width:"100%",padding:"10px"}},(0,e.jsx)("div",null,r.config.placeholder),(0,e.jsx)(n.Select,{onChange:e=>{l(e.target.value)},size:"lg",placeholder:r.config.placeholder},null===(s=r.config.options)||void 0===s?void 0:s.map(((t,o)=>(0,e.jsx)(n.Option,{value:o,key:o},t.displayName)))))))}function c(e){r.p=e}})(),s})())}}}));