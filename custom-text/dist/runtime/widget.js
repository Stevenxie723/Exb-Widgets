/*! For license information please see widget.js.LICENSE.txt */
System.register(["jimu-core","jimu-core/react"],(function(e,t){var n={},r={};return Object.defineProperty(r,"__esModule",{value:!0}),{setters:[function(e){n.DataSourceComponent=e.DataSourceComponent,n.DataSourceManager=e.DataSourceManager,n.JimuFieldType=e.JimuFieldType,n.css=e.css,n.jsx=e.jsx},function(e){Object.keys(e).forEach((function(t){r[t]=e[t]}))}],execute:function(){e((()=>{var e={7154:(e,t,n)=>{"use strict";var r=n(8972);var o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=r.useSyncExternalStore,u=r.useRef,a=r.useEffect,c=r.useMemo,s=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,l){var d=u(null);if(null===d.current){var f={hasValue:!1,value:null};d.current=f}else f=d.current;d=c((function(){function e(e){if(!a){if(a=!0,i=e,e=r(e),void 0!==l&&f.hasValue){var t=f.value;if(l(t,e))return u=t}return u=e}if(t=u,o(i,e))return t;var n=r(e);return void 0!==l&&l(t,n)?t:(i=e,u=n)}var i,u,a=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]}),[t,n,r,l]);var g=i(e,d[0],d[1]);return a((function(){f.hasValue=!0,f.value=g}),[g]),s(g),g}},8418:(e,t,n)=>{"use strict";e.exports=n(7154)},9244:e=>{"use strict";e.exports=n},8972:e=>{"use strict";e.exports=r}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,o),i.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.p="";var i={};return o.p=window.jimuConfig.baseUrl,(()=>{"use strict";o.r(i),o.d(i,{__set_webpack_public_path__:()=>J,default:()=>I});var e=o(9244),t=o(8972),n=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,a)}c((r=r.apply(e,t||[])).next())}))};const r=t=>t===e.JimuFieldType.Number?0:t===e.JimuFieldType.Date?(new Date).getUTCMilliseconds():"",u=t=>{const n=e.DataSourceManager.getInstance().getDataSource(t);return null!=n?n:void 0},a=(e,t)=>{var n;try{const r=null===(n=null==t?void 0:t.getSchema())||void 0===n?void 0:n.fields;if(r){for(const[,t]of Object.entries(r))if(t.alias===e)return[t.name,t.type];for(const[,t]of Object.entries(r))if(t.name===e)return[t.name,t.type]}return[void 0,void 0]}catch(e){return[void 0,void 0]}},c=e=>{let t=0;for(let n=0;n<e.length;n++)if(","===e[n]){if(1===t)return n}else"("===e[n]?t++:")"===e[n]&&t--;return-1},s=(t,o,i,s,d)=>n(void 0,void 0,void 0,(function*(){const f=parseFloat(t);if(!isNaN(f))return f;try{const f=t.substring(0,t.indexOf("("));if(["count","sum","min","max","avg","stddev","var","percentile_cont","percentile_disc"].includes(f)){const e=t.substring(t.indexOf("(")+1,t.indexOf(")")),i=void 0!==o?u(o[void 0!==d?d:0]):void 0;return yield((e,t,o)=>n(void 0,void 0,void 0,(function*(){const[n,i]=a(e,o);try{if(["count","sum","min","max","avg","stddev","var","percentile_cont","percentile_disc"].includes(t)){const e=(yield o.query({outStatistics:[{onStatisticField:n,outStatisticFieldName:"value",statisticType:t}]})).records[0].getFieldValue("value");return null==e?r(i):e}return console.error("Invalid aggregation function:",t),r(i)}catch(e){return console.error("Error fetching or aggregating data:",e),r(i)}})))(e,f,i)}return(e=>/^add\(.+\,.+\)$/.test(e)||/^sub\(.+\,.+\)$/.test(e)||/^mul\(.+\,.+\)$/.test(e)||/^div\(.+\,.+\)$/.test(e))(t)?yield((t,o,i,u,a)=>n(void 0,void 0,void 0,(function*(){try{const n=c(t),s=t.substring(0,t.indexOf("(")),d=t.substring(t.indexOf("(")+1,n),f=t.substring(n+1,t.length-1);let g=yield l(d,o,i,u,a),v=yield l(f,o,i,u,a);if("string"==typeof g&&(g=parseFloat(g)),"string"==typeof v&&(v=parseFloat(v)),isNaN(g)||isNaN(v))return r(e.JimuFieldType.Number);{let t=0;if("div"===s&&0===v)return r(e.JimuFieldType.Number);if("div"===s)t=g/v;else if("add"===s)t=g+v;else if("sub"===s)t=g-v;else{if("mul"!==s)return r(e.JimuFieldType.Number);t=g*v}return t}}catch(t){return console.error("Error dividing values:",t),r(e.JimuFieldType.Number)}})))(t,o,i,s,d):(e=>/^select\(.+\,.+\)$/.test(e))(t)?yield((t,o,i,u)=>n(void 0,void 0,void 0,(function*(){try{const n=c(t),a=parseFloat(t.substring(t.indexOf("(")+1,n));if(isNaN(a)||a<0||a>=o.length)return r(e.JimuFieldType.Number);const s=t.substring(n+1,t.length-1);return yield l(s,o,i,u,a)}catch(t){return console.error("Error selecting values:",t),r(e.JimuFieldType.Number)}})))(t,o,i,s):r(e.JimuFieldType.Number)}catch(t){return console.error("Error parsing function:",t),r(e.JimuFieldType.Number)}})),l=(t,o,i,c,l)=>n(void 0,void 0,void 0,(function*(){if((e=>/^.+\(.+\)$/.test(e))(t))return yield s(t,o,i,c,l);if((e=>/^\d+(\.\d+)?$/.test(e))(t))return parseFloat(t);try{const n=void 0!==o?u(o[void 0!==l?l:0]):void 0;return((t,n,o,i)=>{if(!n)return;let u=i?[i]:n.getSelectedRecords();const[c,s]=a(t,n);0===u.length&&(u=n.getRecords());try{if(!u||0===u.length||void 0===u[0]||null===u[0])return r(s);{const t=u[0].getFieldValue(c);if(null==t)return r(s);if(s!==e.JimuFieldType.Date)return s===e.JimuFieldType.Number?null!=t?t:r(s):t;{const e=new Date(t);if("toLocaleString"===o||void 0===o)return e.toLocaleString();if("toLocaleDateString"===o)return e.toLocaleDateString();if("toLocaleTimeString"===o)return e.toLocaleTimeString()}}}catch(e){return console.error("Error fetching data:",e),r(s)}})(t,n,i,c)}catch(t){return console.error("Error parsing function:",t),r(e.JimuFieldType.String)}})),d=(e,t,r,o,i,u,...a)=>n(void 0,[e,t,r,o,i,u,...a],void 0,(function*(e,t,n,r,o,i,u=!1,a){if(e.includes("[")&&e.includes("]")){const c=e.indexOf("["),s=e.indexOf("]"),l=e.substring(c+1,s),f=a?a[l]:void 0;return e.substring(0,c)+`${f}`+(yield d(e.substring(s+1),t,n,r,o,i,u,a))}if(e.includes("{")&&e.includes("}")){const a=e.indexOf("{"),c=e.indexOf("}"),s=yield l(e.substring(a+1,c),t,n,o);let f=`${s}`;return"number"!=typeof s||u||(f=s.toLocaleString(i,{minimumFractionDigits:r,maximumFractionDigits:r})),e.substring(0,a)+f+(yield d(e.substring(c+1),t,n,r,o))}return e}));var f=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,a)}c((r=r.apply(e,t||[])).next())}))};class g{constructor(e){this.delay=e,this.timeoutId=null}execute(e){return f(this,void 0,void 0,(function*(){this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout((()=>f(this,void 0,void 0,(function*(){try{yield e()}catch(e){console.error("Error in debounced function:",e)}this.timeoutId=null}))),this.delay)}))}}const v=({useDataSources:n,children:r,onDataSourceInfoChange:o,onDataSourceStatusChange:i,onDataSourceCreated:u,useDebounceExecutor:a})=>{const[c]=(0,t.useState)(new g(300)),s=(0,t.useCallback)(((e,t)=>{a||void 0===a?c.execute((()=>{null==o||o(e,t)})):null==o||o(e,t)}),[a,c,o]),l=(0,t.useCallback)(((e,t)=>{a||void 0===a?c.execute((()=>{null==i||i(e,t)})):null==i||i(e,t)}),[a,c,i]),d=(0,t.useCallback)((()=>{let t=r;for(let r=0;r<n.length;r++)t=(0,e.jsx)(e.DataSourceComponent,{useDataSource:n[r],onDataSourceInfoChange:s,onDataSourceStatusChange:l,onDataSourceCreated:u},t);return t}),[r,n,s,l,u]),[f,v]=(0,t.useState)(null);return(0,t.useEffect)((()=>{n&&n.length>0?v(d()):v(r)}),[r,d,n]),f};var y=o(8418),m="default"in t?t.default:t,p=Symbol.for("react-redux-context"),b="undefined"!=typeof globalThis?globalThis:{};function S(){if(!m.createContext)return{};const e=b[p]??(b[p]=new Map);let t=e.get(m.createContext);return t||(t=m.createContext(null),e.set(m.createContext,t)),t}var h=S(),x=()=>{throw new Error("uSES not initialized!")};function D(e=h){return function(){return m.useContext(e)}}var j=D(),O=x,F=(e,t)=>e===t;function w(e=h){const t=e===h?j:D(e),n=(e,n={})=>{const{equalityFn:r=F,devModeChecks:o={}}="function"==typeof n?{equalityFn:n}:n;const{store:i,subscription:u,getServerState:a,stabilityCheck:c,identityFunctionCheck:s}=t(),l=(m.useRef(!0),m.useCallback({[e.name]:t=>e(t)}[e.name],[e,c,o.stabilityCheck])),d=O(u.addNestedSub,i.getState,a||i.getState,l,r);return m.useDebugValue(d),d};return Object.assign(n,{withTypes:()=>n}),n}var C=w();Symbol.for("react.element"),Symbol.for("react.portal"),Symbol.for("react.fragment"),Symbol.for("react.strict_mode"),Symbol.for("react.profiler"),Symbol.for("react.provider"),Symbol.for("react.context"),Symbol.for("react.server_context"),Symbol.for("react.forward_ref"),Symbol.for("react.suspense"),Symbol.for("react.suspense_list"),Symbol.for("react.memo"),Symbol.for("react.lazy"),Symbol.for("react.offscreen"),Symbol.for("react.client.reference");var T=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),N="undefined"!=typeof navigator&&"ReactNative"===navigator.product;T||N?m.useLayoutEffect:m.useEffect;Object.defineProperty,Object.getOwnPropertyNames,Object.getOwnPropertySymbols,Object.getOwnPropertyDescriptor,Object.getPrototypeOf,Object.prototype;var k;k=y.useSyncExternalStoreWithSelector,O=k,(e=>{e})(t.useSyncExternalStore);var E=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,a)}c((r=r.apply(e,t||[])).next())}))};const _=t=>{const{fontSize:n,fontFamily:r,color:o,bold:i,italic:u,underline:a,strike:c}=t;return e.css`
    font-size: ${n};
    font-family: ${r};
    color: ${o};
    font-weight: ${i?"bold":"normal"};
    font-style: ${u?"italic":"normal"};
    text-decoration-line: ${a&&c?"underline line-through":a?"underline":c?"line-through":"none"};
    padding: 0;
  `},$=(n,r,o,i,u,a,c,s)=>E(void 0,void 0,void 0,(function*(){const l=[];let f=[];const g=n.map((e=>e.content));for(let v=0;v<g.length;v++){const y=g[v].split("\n");for(let g=0;g<y.length;g++)g>0&&f.length>0&&(l.push((0,e.jsx)("p",{key:l.length,style:{backgroundColor:"transparent",margin:0,textAlign:r}},f.map(((n,r)=>(0,e.jsx)(t.default.Fragment,{key:r},n))))),f=[]),f.push((0,e.jsx)("span",{key:`${v}-${g}`,css:_(n[v])},yield d(y[g],o,i,u,a,c,!1,s)))}return f.length>0&&l.push((0,e.jsx)("p",{key:l.length,style:{backgroundColor:"transparent",margin:0}},f.map(((n,r)=>(0,e.jsx)(t.default.Fragment,{key:r},n))))),l}));function I(n){const[r,o]=t.default.useState([]),i=C((e=>e.urlParamStore.url_param_store)),u=(0,t.useCallback)((t=>E(this,void 0,void 0,(function*(){const n=e.DataSourceManager.getInstance();let r=t.useDataSources&&t.useDataSources.length>0?n.getDataSource(t.useDataSources[0].dataSourceId):void 0;if(null==r&&(r=void 0),void 0===t.config.lines||null===t.config.lines||0===t.config.lines.length)o([(0,e.jsx)("div",{key:0},"No content")]);else{let e=t.repeatedDataSource?Array.isArray(t.repeatedDataSource)?void 0:t.repeatedDataSource.record:void 0;null==e&&(e=void 0);let n=[];if(t.config.autoBold&&t.config.autoBoldSeparator)for(let e=0;e<t.config.lines.length;e++){const r=t.config.lines[e],o=t.config.lines[e].content.split("\n");for(let e=0;e<o.length;e++){const i=o[e],u=t.config.autoBoldSeparator,a=i.indexOf(u);a>=0?(n.push(Object.assign(Object.assign({},r),{content:i.substring(0,a),bold:!0})),n.push(Object.assign(Object.assign({},r),{content:i.substring(a)+(e<o.length-1?"\n":"")}))):n.push(r)}}else n=Array.from(t.config.lines);const r=void 0===t.useDataSources||null===t.useDataSources||0===t.useDataSources.length?void 0:Array.from(t.useDataSources.map((e=>e.dataSourceId))),u=yield $(Array.from(n),t.config.alignItems||"start",r,t.config.dateTimeFormat,void 0!==t.config.numberRoundTo&&t.config.numberRoundTo>=0?t.config.numberRoundTo:void 0,e,t.config.locale,i);o(u)}}))),[i]),a=(0,t.useCallback)((()=>{u(n)}),[n,u]);t.default.useEffect((()=>{a()}),[a]);const c=e.css`
    display: flex;
    flex-direction: column;
    justify-content: ${n.config.justifyContent||"start"};
    align-items: ${n.config.alignItems||"start"};
    width: 100%;
    height: 100%;
  `;return n.useDataSources&&0!==n.useDataSources.length?(0,e.jsx)(v,{useDataSources:n.useDataSources,onDataSourceInfoChange:a},(0,e.jsx)("div",{css:c},r)):(0,e.jsx)("div",{css:c},r)}function J(e){o.p=e}})(),i})())}}}));