System.register(["jimu-core","jimu-core/react"],(function(e,t){var n={},o={};return{setters:[function(e){n.DataSourceComponent=e.DataSourceComponent,n.DataSourceManager=e.DataSourceManager,n.JimuFieldType=e.JimuFieldType,n.css=e.css,n.jsx=e.jsx},function(e){o.default=e.default,o.useCallback=e.useCallback,o.useEffect=e.useEffect,o.useState=e.useState}],execute:function(){e((()=>{var e={244:e=>{"use strict";e.exports=n},972:e=>{"use strict";e.exports=o}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="";var i={};return r.p=window.jimuConfig.baseUrl,(()=>{"use strict";r.r(i),r.d(i,{__set_webpack_public_path__:()=>S,default:()=>h});var e=r(244),t=r(972),n=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function u(e){try{s(o.next(e))}catch(e){i(e)}}function a(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,a)}s((o=o.apply(e,t||[])).next())}))};const o=t=>t===e.JimuFieldType.Number?0:t===e.JimuFieldType.Date?(new Date).getUTCMilliseconds():"",u=t=>{const n=e.DataSourceManager.getInstance().getDataSource(t);return null!=n?n:void 0},a=(e,t)=>{var n;try{const o=null===(n=null==t?void 0:t.getSchema())||void 0===n?void 0:n.fields;if(o){for(const[,t]of Object.entries(o))if(t.alias===e)return[t.name,t.type];for(const[,t]of Object.entries(o))if(t.name===e)return[t.name,t.type]}return[void 0,void 0]}catch(e){return[void 0,void 0]}},s=e=>{let t=0;for(let n=0;n<e.length;n++)if(","===e[n]){if(1===t)return n}else"("===e[n]?t++:")"===e[n]&&t--;return-1},c=(t,r,i,c,d)=>n(void 0,void 0,void 0,(function*(){const f=parseFloat(t);if(!isNaN(f))return f;try{const f=t.substring(0,t.indexOf("("));if(["count","sum","min","max","avg","stddev","var","percentile_cont","percentile_disc"].includes(f)){const e=t.substring(t.indexOf("(")+1,t.indexOf(")")),i=void 0!==r?u(r[void 0!==d?d:0]):void 0;return yield((e,t,r)=>n(void 0,void 0,void 0,(function*(){const[n,i]=a(e,r);try{if(["count","sum","min","max","avg","stddev","var","percentile_cont","percentile_disc"].includes(t)){const e=(yield r.query({outStatistics:[{onStatisticField:n,outStatisticFieldName:"value",statisticType:t}]})).records[0].getFieldValue("value");return null==e?o(i):e}return console.error("Invalid aggregation function:",t),o(i)}catch(e){return console.error("Error fetching or aggregating data:",e),o(i)}})))(e,f,i)}return(e=>/^add\(.+\,.+\)$/.test(e)||/^sub\(.+\,.+\)$/.test(e)||/^mul\(.+\,.+\)$/.test(e)||/^div\(.+\,.+\)$/.test(e))(t)?yield((t,r,i,u,a)=>n(void 0,void 0,void 0,(function*(){try{const n=s(t),c=t.substring(0,t.indexOf("(")),d=t.substring(t.indexOf("(")+1,n),f=t.substring(n+1,t.length-1);let g=yield l(d,r,i,u,a),m=yield l(f,r,i,u,a);if("string"==typeof g&&(g=parseFloat(g)),"string"==typeof m&&(m=parseFloat(m)),isNaN(g)||isNaN(m))return o(e.JimuFieldType.Number);{let t=0;if("div"===c&&0===m)return o(e.JimuFieldType.Number);if("div"===c)t=g/m;else if("add"===c)t=g+m;else if("sub"===c)t=g-m;else{if("mul"!==c)return o(e.JimuFieldType.Number);t=g*m}return t}}catch(t){return console.error("Error dividing values:",t),o(e.JimuFieldType.Number)}})))(t,r,i,c,d):(e=>/^select\(.+\,.+\)$/.test(e))(t)?yield((t,r,i,u)=>n(void 0,void 0,void 0,(function*(){try{const n=s(t),a=parseFloat(t.substring(t.indexOf("(")+1,n));if(isNaN(a)||a<0||a>=r.length)return o(e.JimuFieldType.Number);const c=t.substring(n+1,t.length-1);return yield l(c,r,i,u,a)}catch(t){return console.error("Error selecting values:",t),o(e.JimuFieldType.Number)}})))(t,r,i,c):o(e.JimuFieldType.Number)}catch(t){return console.error("Error parsing function:",t),o(e.JimuFieldType.Number)}})),l=(t,r,i,s,l)=>n(void 0,void 0,void 0,(function*(){if((e=>/^.+\(.+\)$/.test(e))(t))return yield c(t,r,i,s,l);if((e=>/^\d+(\.\d+)?$/.test(e))(t))return parseFloat(t);try{const n=void 0!==r?u(r[void 0!==l?l:0]):void 0;return((t,n,r,i)=>{if(!n)return;const u=i?[i]:n.getSelectedRecords(),[s,c]=a(t,n);try{if(!u||0===u.length||void 0===u[0]||null===u[0])return o(c);{const t=u[0].getFieldValue(s);if(null==t)return o(c);if(c!==e.JimuFieldType.Date)return c===e.JimuFieldType.Number?null!=t?t:o(c):t;{const e=new Date(t);if("toLocaleString"===r||void 0===r)return e.toLocaleString();if("toLocaleDateString"===r)return e.toLocaleDateString();if("toLocaleTimeString"===r)return e.toLocaleTimeString()}}}catch(e){return console.error("Error fetching data:",e),o(c)}})(t,n,i,s)}catch(t){return console.error("Error parsing function:",t),o(e.JimuFieldType.String)}})),d=(e,t,o,r,i,u,...a)=>n(void 0,[e,t,o,r,i,u,...a],void 0,(function*(e,t,n,o,r,i,u=!1){if(e.includes("{")&&e.includes("}")){const a=e.indexOf("{"),s=e.indexOf("}"),c=yield l(e.substring(a+1,s),t,n,r);let f=`${c}`;return"number"!=typeof c||u||(f=c.toLocaleString(i,{minimumFractionDigits:o,maximumFractionDigits:o})),e.substring(0,a)+f+(yield d(e.substring(s+1),t,n,o,r))}return e}));var f=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function u(e){try{s(o.next(e))}catch(e){i(e)}}function a(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,a)}s((o=o.apply(e,t||[])).next())}))};class g{constructor(e){this.delay=e,this.timeoutId=null}execute(e){return f(this,void 0,void 0,(function*(){this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout((()=>f(this,void 0,void 0,(function*(){try{yield e()}catch(e){console.error("Error in debounced function:",e)}this.timeoutId=null}))),this.delay)}))}}const m=({useDataSources:n,children:o,onDataSourceInfoChange:r,onDataSourceStatusChange:i,onDataSourceCreated:u,useDebounceExecutor:a})=>{const[s]=(0,t.useState)(new g(300)),c=(0,t.useCallback)(((e,t)=>{a||void 0===a?s.execute((()=>{null==r||r(e,t)})):null==r||r(e,t)}),[a,s,r]),l=(0,t.useCallback)(((e,t)=>{a||void 0===a?s.execute((()=>{null==i||i(e,t)})):null==i||i(e,t)}),[a,s,i]),d=(0,t.useCallback)((()=>{let t=o;for(let o=0;o<n.length;o++)t=(0,e.jsx)(e.DataSourceComponent,{useDataSource:n[o],onDataSourceInfoChange:c,onDataSourceStatusChange:l,onDataSourceCreated:u},t);return t}),[o,n,c,l,u]),[f,m]=(0,t.useState)(null);return(0,t.useEffect)((()=>{n&&n.length>0?m(d()):m(o)}),[o,d,n]),f};var v=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function u(e){try{s(o.next(e))}catch(e){i(e)}}function a(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,a)}s((o=o.apply(e,t||[])).next())}))};const p=t=>{const{fontSize:n,fontFamily:o,color:r,bold:i,italic:u,underline:a,strike:s}=t;return e.css`
    font-size: ${n};
    font-family: ${o};
    color: ${r};
    font-weight: ${i?"bold":"normal"};
    font-style: ${u?"italic":"normal"};
    text-decoration-line: ${a&&s?"underline line-through":a?"underline":s?"line-through":"none"};
    padding: 0;
  `},y=(n,o,r,i,u,a,s)=>v(void 0,void 0,void 0,(function*(){const c=[];let l=[];const f=n.map((e=>e.content));for(let g=0;g<f.length;g++){const m=f[g].split("\n");for(let f=0;f<m.length;f++)f>0&&l.length>0&&(c.push((0,e.jsx)("p",{key:c.length,style:{backgroundColor:"transparent",margin:0,textAlign:o}},l.map(((n,o)=>(0,e.jsx)(t.default.Fragment,{key:o},n))))),l=[]),l.push((0,e.jsx)("span",{key:`${g}-${f}`,css:p(n[g])},yield d(m[f],r,i,u,a,s)))}return l.length>0&&c.push((0,e.jsx)("p",{key:c.length,style:{backgroundColor:"transparent",margin:0}},l.map(((n,o)=>(0,e.jsx)(t.default.Fragment,{key:o},n))))),c}));function h(n){const[o,r]=t.default.useState([]),i=(0,t.useCallback)((t=>v(this,void 0,void 0,(function*(){const n=e.DataSourceManager.getInstance();let o=t.useDataSources&&t.useDataSources.length>0?n.getDataSource(t.useDataSources[0].dataSourceId):void 0;if(null==o&&(o=void 0),void 0===t.config.lines||0===t.config.lines.length)r([(0,e.jsx)("div",{key:0},"No content")]);else{let e=t.repeatedDataSource?Array.isArray(t.repeatedDataSource)?void 0:t.repeatedDataSource.record:void 0;null==e&&(e=void 0);let n=[];if(t.config.autoBold&&t.config.autoBoldSeparator)for(let e=0;e<t.config.lines.length;e++){const o=t.config.lines[e],r=t.config.lines[e].content.split("\n");for(let e=0;e<r.length;e++){const i=r[e],u=t.config.autoBoldSeparator,a=i.indexOf(u);a>=0?(n.push(Object.assign(Object.assign({},o),{content:i.substring(0,a),bold:!0})),n.push(Object.assign(Object.assign({},o),{content:i.substring(a)+(e<r.length-1?"\n":"")}))):n.push(o)}}else n=Array.from(t.config.lines);const o=yield y(Array.from(n),t.config.alignItems||"start",Array.from(t.useDataSources.map((e=>e.dataSourceId))),t.config.dateTimeFormat,void 0!==t.config.numberRoundTo&&t.config.numberRoundTo>=0?t.config.numberRoundTo:void 0,e,t.config.locale);r(o)}}))),[]),u=(0,t.useCallback)((()=>{i(n)}),[n,i]);t.default.useEffect((()=>{u()}),[u]);const a=e.css`
    display: flex;
    flex-direction: column;
    justify-content: ${n.config.justifyContent||"start"};
    align-items: ${n.config.alignItems||"start"};
    width: 100%;
    height: 100%;
  `;return n.useDataSources&&0!==n.useDataSources.length?(0,e.jsx)(m,{useDataSources:n.useDataSources,onDataSourceInfoChange:u},(0,e.jsx)("div",{css:a},o)):(0,e.jsx)("div",{css:a},o)}function S(e){r.p=e}})(),i})())}}}));