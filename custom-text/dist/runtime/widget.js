System.register(["jimu-core","jimu-core/react"],(function(e,t){var n={},o={};return{setters:[function(e){n.DataSourceComponent=e.DataSourceComponent,n.DataSourceManager=e.DataSourceManager,n.JimuFieldType=e.JimuFieldType,n.css=e.css,n.jsx=e.jsx},function(e){o.default=e.default,o.useCallback=e.useCallback}],execute:function(){e((()=>{var e={244:e=>{"use strict";e.exports=n},972:e=>{"use strict";e.exports=o}},t={};function i(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,i),r.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="";var r={};return i.p=window.jimuConfig.baseUrl,(()=>{"use strict";i.r(r),i.d(r,{__set_webpack_public_path__:()=>y,default:()=>m});var e=i(244),t=i(972),n=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{u(o.next(e))}catch(e){r(e)}}function s(e){try{u(o.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((o=o.apply(e,t||[])).next())}))};const o=t=>t===e.JimuFieldType.Number?0:t===e.JimuFieldType.Date?(new Date).getUTCMilliseconds():"";function a(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}const s=(e,t)=>{var n;try{const o=null===(n=null==t?void 0:t.getSchema())||void 0===n?void 0:n.fields;if(o)for(const[,t]of Object.entries(o))if(t.alias===e)return[t.name,t.type];return[void 0,void 0]}catch(e){return[void 0,void 0]}},u=/^.+\(.+\)$/,c=/^\d+(\.\d+)?$/,l=(t,i,r,u,c)=>n(void 0,void 0,void 0,(function*(){const l=parseFloat(t);if(!isNaN(l))return l;{const l=t.substring(0,t.indexOf("("));if(["count","sum","min","max","avg","stddev","var","percentile_cont","percentile_disc"].includes(l)){const e=t.substring(t.indexOf("(")+1,t.indexOf(")"));return yield((e,t,i,r)=>n(void 0,void 0,void 0,(function*(){const[n,u]=s(e,i);try{if(["count","sum","min","max","avg","stddev","var","percentile_cont","percentile_disc"].includes(t)){const e=(yield i.query({outStatistics:[{onStatisticField:n,outStatisticFieldName:"value",statisticType:t}]})).records[0].getFieldValue("value");return null==e?o(u):void 0!==r?a(e,r).toFixed(r):e}return console.error("Invalid aggregation function:",t),o(u)}catch(e){return console.error("Error fetching or aggregating data:",e),o(u)}})))(e,l,i,u)}if("div"!==l)return o(e.JimuFieldType.Number);if(!t.includes(","))return console.error("Invalid expression:",t),o(e.JimuFieldType.Number);try{const n=(e=>{let t=0;for(let n=0;n<e.length;n++)if(","===e[n]){if(1===t)return n}else"("===e[n]?t++:")"===e[n]&&t--;return-1})(t),s=t.substring(t.indexOf("(")+1,n),l=t.substring(n+1,t.length-1);let f=yield d(s,i,r,void 0,c),g=yield d(l,i,r,void 0,c);return"string"==typeof f&&(f=parseFloat(f)),"string"==typeof g&&(g=parseFloat(g)),isNaN(f)||isNaN(g)||0===g?o(e.JimuFieldType.Number):void 0!==u?a(f/g,u).toFixed(u):f/g}catch(t){return console.error("Error dividing values:",t),o(e.JimuFieldType.Number)}}})),d=(t,i,r,d,f)=>n(void 0,void 0,void 0,(function*(){return u.test(t)?yield l(t,i,r,d,f):c.test(t)?parseFloat(t):((t,n,i,r,u)=>{if(!n)return;const c=u?[u]:n.getSelectedRecords(),[l,d]=s(t,n);try{if(!c||0===c.length||void 0===c[0]||null===c[0])return o(d);{const t=c[0].getFieldValue(l);if(null==t)return o(d);if(d!==e.JimuFieldType.Date)return d===e.JimuFieldType.Number?null!=t?void 0!==r?a(t,r).toFixed(r):t:o(d):t;{const e=new Date(t);if("toLocaleString"===i||void 0===i)return e.toLocaleString();if("toLocaleDateString"===i)return e.toLocaleDateString();if("toLocaleTimeString"===i)return e.toLocaleTimeString()}}}catch(e){return console.error("Error fetching data:",e),o(d)}})(t,i,r,d,f)})),f=(e,t,o,i,r)=>n(void 0,void 0,void 0,(function*(){if(e.includes("{")&&e.includes("}")){const n=e.indexOf("{"),a=e.indexOf("}"),s=yield d(e.substring(n+1,a),t,o,i,r);return e.substring(0,n)+`${s}`+(yield f(e.substring(a+1),t,o,i,r))}return e}));var g=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{u(o.next(e))}catch(e){r(e)}}function s(e){try{u(o.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((o=o.apply(e,t||[])).next())}))};const p=t=>{const{fontSize:n,fontFamily:o,color:i,bold:r,italic:a,underline:s,strike:u}=t;return e.css`
    font-size: ${n};
    font-family: ${o};
    color: ${i};
    font-weight: ${r?"bold":"normal"};
    font-style: ${a?"italic":"normal"};
    text-decoration-line: ${s&&u?"underline line-through":s?"underline":u?"line-through":"none"};
    padding: 0;
  `},v=(n,o,i,r,a,s)=>g(void 0,void 0,void 0,(function*(){const u=[];let c=[];const l=n.map((e=>e.content));for(let d=0;d<l.length;d++){const g=l[d].split("\n");for(let l=0;l<g.length;l++)l>0&&c.length>0&&(u.push((0,e.jsx)("p",{key:u.length,style:{backgroundColor:"transparent",margin:0,textAlign:o}},c.map(((n,o)=>(0,e.jsx)(t.default.Fragment,{key:o},n))))),c=[]),c.push((0,e.jsx)("span",{key:`${d}-${l}`,css:p(n[d])},yield f(g[l],i,r,a,s)))}return c.length>0&&u.push((0,e.jsx)("p",{key:u.length,style:{backgroundColor:"transparent",margin:0}},c.map(((n,o)=>(0,e.jsx)(t.default.Fragment,{key:o},n))))),u}));function m(n){const[o,i]=t.default.useState([]),r=(0,t.useCallback)((t=>g(this,void 0,void 0,(function*(){const n=e.DataSourceManager.getInstance();let o=t.useDataSources&&t.useDataSources.length>0?n.getDataSource(t.useDataSources[0].dataSourceId):void 0;if(null==o&&(o=void 0),void 0===t.config.lines||0===t.config.lines.length)i([(0,e.jsx)("div",{key:0},"No content")]);else{let e=t.repeatedDataSource?Array.isArray(t.repeatedDataSource)?void 0:t.repeatedDataSource.record:void 0;null==e&&(e=void 0);let n=[];if(t.config.autoBold&&t.config.autoBoldSeparator)for(let e=0;e<t.config.lines.length;e++){const o=t.config.lines[e],i=t.config.lines[e].content.split("\n");for(let e=0;e<i.length;e++){const r=i[e],a=t.config.autoBoldSeparator,s=r.indexOf(a);s>=0?(n.push(Object.assign(Object.assign({},o),{content:r.substring(0,s),bold:!0})),n.push(Object.assign(Object.assign({},o),{content:r.substring(s)+(e<i.length-1?"\n":"")}))):n.push(o)}}else n=Array.from(t.config.lines);const r=yield v(Array.from(n),t.config.alignItems||"start",o,t.config.dateTimeFormat,void 0!==t.config.numberRoundTo&&t.config.numberRoundTo>=0?t.config.numberRoundTo:void 0,e);i(r)}}))),[]),a=(0,t.useCallback)((()=>{r(n)}),[n,r]);t.default.useEffect((()=>{a()}),[a]);const s=e.css`
    display: flex;
    flex-direction: column;
    justify-content: ${n.config.justifyContent||"start"};
    align-items: ${n.config.alignItems||"start"};
    width: 100%;
    height: 100%;
  `;return n.useDataSources&&0!==n.useDataSources.length?(0,e.jsx)(e.DataSourceComponent,{widgetId:n.id,useDataSource:n.useDataSources[0],onDataSourceInfoChange:a,onDataSourceCreated:a,onDataSourceSchemaChange:a},(0,e.jsx)("div",{css:s},o)):(0,e.jsx)("div",{css:s},o)}function y(e){i.p=e}})(),r})())}}}));