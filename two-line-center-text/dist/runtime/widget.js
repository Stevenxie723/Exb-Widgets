System.register(["jimu-core","jimu-core/react"],(function(e,t){var n={},i={};return{setters:[function(e){n.DataSourceComponent=e.DataSourceComponent,n.DataSourceManager=e.DataSourceManager,n.JimuFieldType=e.JimuFieldType,n.css=e.css,n.jsx=e.jsx},function(e){i.useCallback=e.useCallback,i.useEffect=e.useEffect,i.useState=e.useState}],execute:function(){e((()=>{var e={244:e=>{"use strict";e.exports=n},972:e=>{"use strict";e.exports=i}},t={};function o(n){var i=t[n];if(void 0!==i)return i.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,o),r.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.p="";var r={};return o.p=window.jimuConfig.baseUrl,(()=>{"use strict";o.r(r),o.d(r,{__set_webpack_public_path__:()=>p,default:()=>v});var e=o(244),t=o(972),n=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{u(i.next(e))}catch(e){r(e)}}function c(e){try{u(i.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}u((i=i.apply(e,t||[])).next())}))};const i=t=>t===e.JimuFieldType.Number?0:t===e.JimuFieldType.Date?(new Date).getUTCMilliseconds():"";function s(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}const c=(e,t)=>{var n;try{const i=null===(n=null==t?void 0:t.getSchema())||void 0===n?void 0:n.fields;if(i)for(const[,t]of Object.entries(i))if(t.alias===e)return[t.name,t.type];return[void 0,void 0]}catch(e){return[void 0,void 0]}},u=/^.+\(.+\)$/,a=/^\d+(\.\d+)?$/,l=(t,o,r,u,a)=>n(void 0,void 0,void 0,(function*(){const l=parseFloat(t);if(!isNaN(l))return l;{const l=t.substring(0,t.indexOf("("));if(["count","sum","min","max","avg","stddev","var","percentile_cont","percentile_disc"].includes(l)){const e=t.substring(t.indexOf("(")+1,t.indexOf(")"));return yield((e,t,o,r)=>n(void 0,void 0,void 0,(function*(){const[n,u]=c(e,o);try{if(["count","sum","min","max","avg","stddev","var","percentile_cont","percentile_disc"].includes(t)){const e=(yield o.query({outStatistics:[{onStatisticField:n,outStatisticFieldName:"value",statisticType:t}]})).records[0].getFieldValue("value");return null==e?i(u):void 0!==r?s(e,r).toFixed(r):e}return console.error("Invalid aggregation function:",t),i(u)}catch(e){return console.error("Error fetching or aggregating data:",e),i(u)}})))(e,l,o,u)}if("div"!==l)return i(e.JimuFieldType.Number);if(!t.includes(","))return console.error("Invalid expression:",t),i(e.JimuFieldType.Number);try{const n=(e=>{let t=0;for(let n=0;n<e.length;n++)if(","===e[n]){if(1===t)return n}else"("===e[n]?t++:")"===e[n]&&t--;return-1})(t),c=t.substring(t.indexOf("(")+1,n),l=t.substring(n+1,t.length-1);let f=yield d(c,o,r,void 0,a),g=yield d(l,o,r,void 0,a);return"string"==typeof f&&(f=parseFloat(f)),"string"==typeof g&&(g=parseFloat(g)),isNaN(f)||isNaN(g)||0===g?i(e.JimuFieldType.Number):void 0!==u?s(f/g,u).toFixed(u):f/g}catch(t){return console.error("Error dividing values:",t),i(e.JimuFieldType.Number)}}})),d=(t,o,r,d,f)=>n(void 0,void 0,void 0,(function*(){return u.test(t)?yield l(t,o,r,d,f):a.test(t)?parseFloat(t):((t,n,o,r,u)=>{if(!n)return;const a=u?[u]:n.getSelectedRecords(),[l,d]=c(t,n);try{if(!a||0===a.length||void 0===a[0]||null===a[0])return i(d);{const t=a[0].getFieldValue(l);if(null==t)return i(d);if(d!==e.JimuFieldType.Date)return d===e.JimuFieldType.Number?null!=t?void 0!==r?s(t,r).toFixed(r):t:i(d):t;{const e=new Date(t);if("toLocaleString"===o||void 0===o)return e.toLocaleString();if("toLocaleDateString"===o)return e.toLocaleDateString();if("toLocaleTimeString"===o)return e.toLocaleTimeString()}}}catch(e){return console.error("Error fetching data:",e),i(d)}})(t,o,r,d,f)})),f=(e,t,i,o,r)=>n(void 0,void 0,void 0,(function*(){if(e.includes("{")&&e.includes("}")){const n=e.indexOf("{"),s=e.indexOf("}"),c=yield d(e.substring(n+1,s),t,i,o,r);return e.substring(0,n)+`${c}`+(yield f(e.substring(s+1),t,i,o,r))}return e})),g=(t,n,i,o,r,s,c)=>e.css`
    font-size: ${n};
    font-family: ${t};
    color: ${i};
    font-weight: ${o?"bold":"normal"};
    font-style: ${r?"italic":"normal"};
    text-decoration-line: ${s&&c?"underline line-through":s?"underline":c?"line-through":"none"};
    padding: 0;
  `;function v(n){const i=e.css`
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  `,o=g(n.config.firstLineFontFamily,n.config.firstLineFontSize,n.config.firstLineColor,n.config.firstLineBold,n.config.firstLineItalic,n.config.firstLineUnderline,n.config.firstLineStrike),r=g(n.config.secondLineFontFamily,n.config.secondLineFontSize,n.config.secondLineColor,n.config.secondLineBold,n.config.secondLineItalic,n.config.secondLineUnderline,n.config.secondLineStrike),[s,c]=(0,t.useState)(""),[u,a]=(0,t.useState)(""),l=(0,t.useCallback)((()=>{const t=e.DataSourceManager.getInstance();let i=n.useDataSources&&n.useDataSources.length>0?t.getDataSource(n.useDataSources[0].dataSourceId):void 0;null==i&&(i=void 0),f(n.config.firstLine,i).then((e=>{c(e)})),f(n.config.secondLine,i).then((e=>{a(e)}))}),[c,a,n]);return(0,t.useEffect)((()=>{l()}),[l]),n.useDataSources&&0!==n.useDataSources.length?(0,e.jsx)(e.DataSourceComponent,{useDataSource:n.useDataSources[0],onDataSourceInfoChange:l},(0,e.jsx)("div",{className:"widget-get-map-coordinates jimu-widget p-2",css:i},(0,e.jsx)("div",{style:{textAlign:"center",flexWrap:"wrap"}},(0,e.jsx)("div",{css:o},s),(0,e.jsx)("div",{css:r},u)))):(0,e.jsx)("div",{css:i},"Please configure the data source")}function p(e){o.p=e}})(),r})())}}}));