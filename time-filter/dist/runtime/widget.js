System.register(["jimu-core","jimu-core/react","jimu-ui","jimu-ui/advanced/setting-components","jimu-ui/advanced/style-setting-components","jimu-ui/basic/color-picker"],(function(e,t){var n={},a={},i={},o={},s={},r={};return{setters:[function(e){n.DataSourceComponent=e.DataSourceComponent,n.DataSourceManager=e.DataSourceManager,n.css=e.css,n.jsx=e.jsx},function(e){a.useCallback=e.useCallback,a.useEffect=e.useEffect,a.useState=e.useState},function(){},function(){},function(){},function(){}],execute:function(){e((()=>{var e={9244:e=>{"use strict";e.exports=n},8972:e=>{"use strict";e.exports=a},4321:e=>{"use strict";e.exports=i},9298:e=>{"use strict";e.exports=o},5562:e=>{"use strict";e.exports=s},4337:e=>{"use strict";e.exports=r}},t={};function l(n){var a=t[n];if(void 0!==a)return a.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,l),i.exports}l.d=(e,t)=>{for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.p="";var c={};return l.p=window.jimuConfig.baseUrl,(()=>{"use strict";l.r(c),l.d(c,{__set_webpack_public_path__:()=>y,default:()=>x});var e=l(9244),t=l(8972),n=function(e,t,n,a){return new(n||(n=Promise))((function(i,o){function s(e){try{l(a.next(e))}catch(e){o(e)}}function r(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,r)}l((a=a.apply(e,t||[])).next())}))};class a{constructor(e){this.delay=e,this.timeoutId=null}execute(e){return n(this,void 0,void 0,(function*(){this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout((()=>n(this,void 0,void 0,(function*(){try{yield e()}catch(e){console.error("Error in debounced function:",e)}this.timeoutId=null}))),this.delay)}))}}const i=({useDataSources:n,children:i,onDataSourceInfoChange:o,onDataSourceStatusChange:s,onDataSourceCreated:r,useDebounceExecutor:l})=>{const[c]=(0,t.useState)(new a(300)),u=(0,t.useCallback)(((e,t)=>{l||void 0===l?c.execute((()=>{null==o||o(e,t)})):null==o||o(e,t)}),[l,c,o]),d=(0,t.useCallback)(((e,t)=>{l||void 0===l?c.execute((()=>{null==s||s(e,t)})):null==s||s(e,t)}),[l,c,s]),f=(0,t.useCallback)((()=>{let t=i;for(let a=0;a<n.length;a++)t=(0,e.jsx)(e.DataSourceComponent,{useDataSource:n[a],onDataSourceInfoChange:u,onDataSourceStatusChange:d,onDataSourceCreated:r},t);return t}),[i,n,u,d,r]),[g,h]=(0,t.useState)(null);return(0,t.useEffect)((()=>{n&&n.length>0?h(f()):h(i)}),[i,f,n]),g},o="\u9078\u64c7\u8d77\u59cb\u65e5\u671f",s="\u9078\u64c7\u7d50\u675f\u65e5\u671f",r="~",u="\u9078\u64c7\u6642\u9593\u6bb5",d="All";const f=e=>{const n=((e=200)=>{const[n,a]=(0,t.useState)({width:window.innerWidth,height:window.innerHeight});return(0,t.useEffect)((()=>{let t;const n=()=>{clearTimeout(t),t=setTimeout((()=>{a({width:window.innerWidth,height:window.innerHeight})}),e)};return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n),clearTimeout(t)}}),[e]),n})(),a=(0,t.useCallback)((e=>{let t=0,a="px";return"string"==typeof e&&e.endsWith("vw")?(t=parseFloat(e.substring(0,e.length-2)),a="vw"):"string"==typeof e&&e.endsWith("px")?(t=parseFloat(e.substring(0,e.length-2)),a="px"):t=0,"vw"===a?(i=t,o=n.width,i/100*o):t;var i,o}),[n.width]),[i,o]=(0,t.useState)(a(e));return(0,t.useEffect)((()=>{o(a(e))}),[e,a]),i};l(4321),l(9298),l(5562),l(4337);const g=t=>{if(!t)return e.css``;const{fontSize:n,fontFamily:a,color:i,bold:o,italic:s,underline:r,strike:l}=t;return e.css`
    font-size: ${n};
    font-family: ${a};
    color: ${i};
    font-weight: ${o?"bold":"normal"};
    font-style: ${s?"italic":"normal"};
    text-decoration-line: ${r&&l?"underline line-through":r?"underline":l?"line-through":"none"};
    padding: 0;
  `},h=(e,t)=>{const n=new Date(e);return t?n.setHours(0,0,0,0):n.setHours(23,59,59,999),n.getTime()},p=({setDate:n,title:a,defaultDate:i,dateSelectionConfig:o})=>{const s=(0,t.useCallback)((e=>{try{const t=new Date(e.target.value);n(t.getTime())}catch(e){}}),[n]),r=(0,t.useCallback)((e=>{try{return void 0!==e?new Date(e).toLocaleDateString("en-CA"):""}catch(e){return""}}),[]);return(0,e.jsx)("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",alignItems:"start",padding:"10px",flexDirection:"column"}},(0,e.jsx)("input",{type:"date",style:{width:"100%",fontSize:"16px"},css:g(o),onChange:s,value:r(i)}))},D=({setStartDateAndApplyFileter:n,setEndDateAndApplyFileter:a,range:i,titleStyle:l,dateExpressionStyle:c,dateSelectionConfig:D})=>{var x;const[y,S]=(0,t.useState)(!1),w=f(null!==(x=null==l?void 0:l.fontSize)&&void 0!==x?x:"16px");return(0,e.jsx)("div",{style:{height:y?"200%":"100%",width:"100%",display:"flex",flexDirection:"column",overflow:"visible",justifyContent:"flex-start",alignItems:"flex-start",backgroundColor:"yellow"}},(0,e.jsx)("div",{onClick:()=>{S(!y)},style:{backgroundColor:"white",color:"white",width:"100%",height:"100%",alignItems:"center",justifyContent:"flex-start",display:"flex",border:"1px solid black"}},(0,e.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",flexWrap:"wrap",padding:"5px",gap:"15px"}},(0,e.jsx)("img",{src:"https://idtwebgis.igis.com.tw/toafportal/sharing/rest/content/items/f46cdc5994fb4a85990e02f1cfc0922a/data",height:2*w,width:2*w}),(0,e.jsx)("div",{css:g(l)},u),(0,e.jsx)("div",{css:g(c)},(e=>{try{const t=h(Date.now(),!0);return 0===e.startDate&&e.endDate>=t?d:0===e.startDate?`~ ${new Date(e.endDate).toLocaleDateString()}`:e.endDate>=t?`${new Date(e.startDate).toLocaleDateString()} ~`:`${new Date(e.startDate).toLocaleDateString()} ~ ${new Date(e.endDate).toLocaleDateString()}`}catch(t){return`Invalid date: ${e.startDate} ~ ${e.endDate}`}})(i)))),y&&(0,e.jsx)("div",{style:{width:"100%",height:"100%",backgroundColor:"white",display:"flex",justifyContent:"center",alignItems:"center",color:"white",fontSize:"24px"}},(0,e.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"}},(0,e.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"}},(0,e.jsx)("div",{style:{width:"45%"}},(0,e.jsx)(p,{setDate:n,title:o,defaultDate:i.startDate,dateSelectionConfig:D})),(0,e.jsx)("div",{style:{width:"5%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"transparent"}},(0,e.jsx)("div",{style:{fontFamily:"Avenir Next",fontSize:"20px",backgroundColor:"transparent",color:"black"}},r)),(0,e.jsx)("div",{style:{width:"45%"}},(0,e.jsx)(p,{setDate:a,title:s,defaultDate:i.endDate,dateSelectionConfig:D}))))))};function x(n){const[a]=(0,t.useState)(Date.now()),[o,s]=(0,t.useState)({startDate:0,endDate:a}),r=(0,t.useCallback)(((t,a)=>{try{if(!n.useDataSources||0===n.useDataSources.length||void 0===n.config.fieldNames)return;if(n.useDataSources.length!==n.config.fieldNames.length)return;for(let i=0;i<n.useDataSources.length;i++){const o=e.DataSourceManager.getInstance().getDataSource(n.useDataSources[i].dataSourceId);if(null==o||void 0===n.config.fieldNames[i])continue;const s={where:`${n.config.fieldNames[i]} >= '${new Date(t).toISOString()}' AND ${n.config.fieldNames[i]} <= '${new Date(a).toISOString()}'`};o.updateQueryParams(s,n.id)}}catch(e){console.error(e)}}),[n.config.fieldNames,n.id,n.useDataSources]),l=(0,t.useCallback)((()=>{r(o.startDate,o.endDate)}),[o,r]),c=(0,t.useCallback)((e=>{s((t=>{const n=Object.assign(Object.assign({},t),{startDate:h(e,!0)});return r(n.startDate,n.endDate),n}))}),[r]),u=(0,t.useCallback)((e=>{s((t=>{const n=Object.assign(Object.assign({},t),{endDate:h(e,!1)});return r(n.startDate,n.endDate),n}))}),[r]);return(0,e.jsx)(i,{useDataSources:n.useDataSources,onDataSourceCreated:l},(0,e.jsx)("div",{style:{display:"flex",overflow:"visible",width:"100%",height:"100%",justifyContent:"flex-start",alignItems:"flex-start"}},(0,e.jsx)(D,{range:o,titleStyle:n.config.titleConfig,dateExpressionStyle:n.config.dateExpressionConfig,setStartDateAndApplyFileter:c,setEndDateAndApplyFileter:u,dateSelectionConfig:n.config.dateSelectionConfig})))}function y(e){l.p=e}})(),c})())}}}));