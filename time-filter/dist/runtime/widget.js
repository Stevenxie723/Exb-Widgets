System.register(["jimu-core","jimu-core/react","jimu-ui","jimu-ui/advanced/setting-components","jimu-ui/advanced/style-setting-components","jimu-ui/basic/color-picker"],(function(e,t){var n={},i={},a={},o={},s={},r={};return{setters:[function(e){n.DataSourceComponent=e.DataSourceComponent,n.DataSourceManager=e.DataSourceManager,n.css=e.css,n.jsx=e.jsx},function(e){i.useCallback=e.useCallback,i.useEffect=e.useEffect,i.useState=e.useState},function(){},function(){},function(){},function(){}],execute:function(){e((()=>{var e={244:e=>{"use strict";e.exports=n},972:e=>{"use strict";e.exports=i},321:e=>{"use strict";e.exports=a},298:e=>{"use strict";e.exports=o},562:e=>{"use strict";e.exports=s},337:e=>{"use strict";e.exports=r}},t={};function l(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,l),a.exports}l.d=(e,t)=>{for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.p="";var c={};return l.p=window.jimuConfig.baseUrl,(()=>{"use strict";l.r(c),l.d(c,{__set_webpack_public_path__:()=>y,default:()=>D});var e=l(244),t=l(972),n=function(e,t,n,i){return new(n||(n=Promise))((function(a,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function r(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,r)}l((i=i.apply(e,t||[])).next())}))};class i{constructor(e){this.delay=e,this.timeoutId=null}execute(e){return n(this,void 0,void 0,(function*(){this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout((()=>n(this,void 0,void 0,(function*(){try{yield e()}catch(e){console.error("Error in debounced function:",e)}this.timeoutId=null}))),this.delay)}))}}const a=({useDataSources:n,children:a,onDataSourceInfoChange:o,onDataSourceCreated:s,useDebounceExecutor:r})=>{const[l]=(0,t.useState)(new i(100)),c=(0,t.useCallback)(((e,t)=>{r?l.execute((()=>{null==o||o(e,t)})):null==o||o(e,t)}),[r,l,o]),u=(0,t.useCallback)((()=>{let t=a;for(let i=0;i<n.length;i++)t=(0,e.jsx)(e.DataSourceComponent,{useDataSource:n[i],onDataSourceInfoChange:c,onDataSourceCreated:s},t);return t}),[a,n,c,s]),[d,f]=(0,t.useState)(null);return(0,t.useEffect)((()=>{n&&n.length>0?f(u()):f(a)}),[a,u,n]),d},o="\u9078\u64c7\u8d77\u59cb\u65e5\u671f",s="\u9078\u64c7\u7d50\u675f\u65e5\u671f",r="~",u="\u9078\u64c7\u6642\u9593\u6bb5",d="All";const f=e=>{const n=((e=200)=>{const[n,i]=(0,t.useState)({width:window.innerWidth,height:window.innerHeight});return(0,t.useEffect)((()=>{let t;const n=()=>{clearTimeout(t),t=setTimeout((()=>{i({width:window.innerWidth,height:window.innerHeight})}),e)};return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n),clearTimeout(t)}}),[e]),n})(),i=(0,t.useCallback)((e=>{let t=0,i="px";return"string"==typeof e&&e.endsWith("vw")?(t=parseFloat(e.substring(0,e.length-2)),i="vw"):"string"==typeof e&&e.endsWith("px")?(t=parseFloat(e.substring(0,e.length-2)),i="px"):t=0,"vw"===i?(a=t,o=n.width,a/100*o):t;var a,o}),[n.width]),[a,o]=(0,t.useState)(i(e));return(0,t.useEffect)((()=>{o(i(e))}),[e,i]),a};l(321),l(298),l(562),l(337);const g=t=>{if(!t)return e.css``;const{fontSize:n,fontFamily:i,color:a,bold:o,italic:s,underline:r,strike:l}=t;return e.css`
    font-size: ${n};
    font-family: ${i};
    color: ${a};
    font-weight: ${o?"bold":"normal"};
    font-style: ${s?"italic":"normal"};
    text-decoration-line: ${r&&l?"underline line-through":r?"underline":l?"line-through":"none"};
    padding: 0;
  `},h=(e,t)=>{const n=new Date(e);return t?n.setHours(0,0,0,0):n.setHours(23,59,59,999),n.getTime()},p=({setDate:t,title:n,defaultDate:i,dateSelectionConfig:a})=>(0,e.jsx)("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",alignItems:"start",padding:"10px",flexDirection:"column"}},(0,e.jsx)("input",{type:"date",style:{width:"100%",fontSize:"16px"},css:g(a),onChange:e=>{const n=new Date(e.target.value);t(n.getTime())},value:void 0!==i?new Date(i).toLocaleDateString("en-CA"):""})),x=({setStartDateAndApplyFileter:n,setEndDateAndApplyFileter:i,range:a,titleStyle:l,dateExpressionStyle:c,dateSelectionConfig:x})=>{var D;const[y,w]=(0,t.useState)(!1),S=f(null!==(D=null==l?void 0:l.fontSize)&&void 0!==D?D:"16px");return(0,e.jsx)("div",{style:{height:y?"200%":"100%",width:"100%",display:"flex",flexDirection:"column",overflow:"visible",justifyContent:"flex-start",alignItems:"flex-start",backgroundColor:"yellow"}},(0,e.jsx)("div",{onClick:()=>{w(!y)},style:{backgroundColor:"white",color:"white",width:"100%",height:"100%",alignItems:"center",justifyContent:"flex-start",display:"flex",border:"1px solid black"}},(0,e.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",flexWrap:"wrap",padding:"5px",gap:"15px"}},(0,e.jsx)("img",{src:"https://idtwebgis.igis.com.tw/toafportal/sharing/rest/content/items/f46cdc5994fb4a85990e02f1cfc0922a/data",height:2*S,width:2*S}),(0,e.jsx)("div",{css:g(l)},u),(0,e.jsx)("div",{css:g(c)},(e=>{const t=h(Date.now(),!0);return 0===e.startDate&&e.endDate>=t?d:0===e.startDate?`~ ${new Date(e.endDate).toLocaleDateString()}`:e.endDate>=t?`${new Date(e.startDate).toLocaleDateString()} ~`:`${new Date(e.startDate).toLocaleDateString()} ~ ${new Date(e.endDate).toLocaleDateString()}`})(a)))),y&&(0,e.jsx)("div",{style:{width:"100%",height:"100%",backgroundColor:"white",display:"flex",justifyContent:"center",alignItems:"center",color:"white",fontSize:"24px"}},(0,e.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"}},(0,e.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"}},(0,e.jsx)("div",{style:{width:"45%"}},(0,e.jsx)(p,{setDate:n,title:o,defaultDate:a.startDate,dateSelectionConfig:x})),(0,e.jsx)("div",{style:{width:"5%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"transparent"}},(0,e.jsx)("div",{style:{fontFamily:"Avenir Next",fontSize:"20px",backgroundColor:"transparent",color:"black"}},r)),(0,e.jsx)("div",{style:{width:"45%"}},(0,e.jsx)(p,{setDate:i,title:s,defaultDate:a.endDate,dateSelectionConfig:x}))))))};function D(n){const[i]=(0,t.useState)(Date.now()),[o,s]=(0,t.useState)({startDate:0,endDate:i}),r=(0,t.useCallback)(((t,i)=>{if(n.useDataSources&&0!==n.useDataSources.length&&void 0!==n.config.fieldNames&&n.useDataSources.length===n.config.fieldNames.length)for(let a=0;a<n.useDataSources.length;a++){const o=e.DataSourceManager.getInstance().getDataSource(n.useDataSources[a].dataSourceId);if(null==o||void 0===n.config.fieldNames[a])continue;const s={where:`${n.config.fieldNames[a]} >= '${new Date(t).toISOString()}' AND ${n.config.fieldNames[a]} <= '${new Date(i).toISOString()}'`};o.updateQueryParams(s,n.id)}}),[n.config.fieldNames,n.id,n.useDataSources]),l=(0,t.useCallback)((()=>{r(o.startDate,o.endDate)}),[o,r]),c=(0,t.useCallback)((e=>{s((t=>{const n=Object.assign(Object.assign({},t),{startDate:h(e,!0)});return r(n.startDate,n.endDate),n}))}),[r]),u=(0,t.useCallback)((e=>{s((t=>{const n=Object.assign(Object.assign({},t),{endDate:h(e,!1)});return r(n.startDate,n.endDate),n}))}),[r]);return(0,e.jsx)(a,{useDataSources:n.useDataSources,onDataSourceCreated:l},(0,e.jsx)("div",{style:{display:"flex",overflow:"visible",width:"100%",height:"100%",justifyContent:"flex-start",alignItems:"flex-start"}},(0,e.jsx)(x,{range:o,titleStyle:n.config.titleConfig,dateExpressionStyle:n.config.dateExpressionConfig,setStartDateAndApplyFileter:c,setEndDateAndApplyFileter:u,dateSelectionConfig:n.config.dateSelectionConfig})))}function y(e){l.p=e}})(),c})())}}}));